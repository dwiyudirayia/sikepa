(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{UBhW:function(e,a,t){"use strict";var n=t("ta7f"),r={name:"prbj-page",props:["isWriteable","step"],components:{Datepicker:t("+jP+").a},data:function(){return{curStep:4,form:{nomor:"",tanggal:moment().format("YYYY-MM-DD"),kebutuhan:0,metode:0,sumber_anggaran:0,nomor_sumber:""},rpbjSetted:!1}},validations:{form:{tanggal:{required:n.required},kebutuhan:{required:n.required},metode:{required:n.required},sumber_anggaran:{required:n.required},nomor_sumber:{required:n.required}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(e){this.$store.commit("pengajuan/setOneData",e)}},rpbName:function(){return 0==this.pengajuan.jenis_pekerjaan?"RPB":"RPJ"}},watch:{"form.sumber_anggaran":function(e){2==e&&""==this.form.nomor_sumber&&(this.form.nomor_sumber=this.pengajuan.prk.no_prk)}},created:function(){null!=this.pengajuan.rpbj?(this.form={nomor:this.pengajuan.rpbj.nomor,tanggal:new Date(this.pengajuan.rpbj.tanggal),kebutuhan:this.pengajuan.rpbj.kebutuhan,metode:this.pengajuan.rpbj.metode,sumber_anggaran:this.pengajuan.rpbj.sumber_anggaran,nomor_sumber:this.pengajuan.rpbj.nomor_sumber},this.$emit("onRpbjLoaded",!0),this.rpbjSetted=!0):(this.form.nomor="[AUTO GENERATED]",this.form.tanggal=new Date)},methods:{submitRpbj:function(e){var a=this;if(e.preventDefault(),this.isWriteable){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.form.p_id=this.pengajuan.id,this.$store.dispatch("pengajuan/saveRpbj",this.form).then(function(e){a.rpbjSetted=!0,a.$emit("onRpbjLoaded",!0),a.Web.showAlert({text:"Data saved"}),a.download("rpbj/"+a.pengajuan.id,a.rpbName+".docx")}).catch(function(e){a.Web.showAlert({text:"Save data failed : "+e.message,type:"warning"})})}else this.download("rpbj/"+this.pengajuan.id,this.rpbName+".docx")}}},s=t("KHd+"),o=Object(s.a)(r,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("b-card-body",[t("h5",[e._v("\n    Form /\n    "),t("span",{staticClass:"font-weight-light"},[e._v(e._s(e.rpbName))])]),e._v(" "),t("b-form-row",[e.rpbjSetted?t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor","label-align-md":"right","label-cols-md":2}},[t("b-input",{attrs:{disabled:!0},model:{value:e.form.nomor,callback:function(a){e.$set(e.form,"nomor","string"==typeof a?a.trim():a)},expression:"form.nomor"}})],1):e._e()],1),e._v(" "),t("b-form-row",[t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal","label-align-md":"right","label-cols-md":2}},[t("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!1,disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final)},model:{value:e.form.tanggal,callback:function(a){e.$set(e.form,"tanggal",a)},expression:"form.tanggal"}})],1)],1),e._v(" "),t("b-form-row",[t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Kebutuhan","label-align-md":"right","label-cols-md":2}},[t("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"Rutin",1:"Non Rutin",2:"Investasi"}},model:{value:e.form.kebutuhan,callback:function(a){e.$set(e.form,"kebutuhan",a)},expression:"form.kebutuhan"}})],1)],1),e._v(" "),t("b-form-row",[t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Metode","label-align-md":"right","label-cols-md":2}},[t("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"Pelelangan",1:"Penunjukkan Langsung",2:"Pengadaan Langsung"}},model:{value:e.form.metode,callback:function(a){e.$set(e.form,"metode",a)},expression:"form.metode"}})],1)],1),e._v(" "),t("b-form-row",[t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sumber Anggaran","label-align-md":"right","label-cols-md":2}},[t("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"SKKO",1:"SKKI",2:"PRK"}},model:{value:e.form.sumber_anggaran,callback:function(a){e.$set(e.form,"sumber_anggaran",a)},expression:"form.sumber_anggaran"}})],1)],1),e._v(" "),t("b-form-row",[t("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor Sumber","label-align-md":"right","label-cols-md":2}},[t("b-input",{attrs:{state:e.$v.form.nomor_sumber.$error?"invalid":"",placeholder:"Nomor Sumber",disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final)},on:{blur:function(a){return e.$v.form.nomor_sumber.$touch()}},model:{value:e.form.nomor_sumber,callback:function(a){e.$set(e.form,"nomor_sumber","string"==typeof a?a.trim():a)},expression:"form.nomor_sumber"}}),e._v(" "),t("invalid-tooltip",{attrs:{inputItem:e.$v.form.nomor_sumber,fieldName:"Nomor Sumber"}})],1)],1),e._v(" "),t("div",{staticClass:"text-right"},[t("b-btn",{staticClass:"btn btn-secondary btn-sm mr-2",attrs:{disabled:!e.pengajuan.evaluasi_final},on:{click:e.submitRpbj}},[t("i",{staticClass:"ion ion-md-cloud-download"}),e._v("\n      "+e._s(e.isWriteable?"Isi dan ":"")+" Unduh dokumen "+e._s(e.rpbName)+"\n    ")])],1)],1)},[],!1,null,null,null);a.a=o.exports},ypyu:function(e,a,t){"use strict";t.r(a);var n=t("+TlC"),r=t("UBhW"),s={name:"pengajuan-step-4",props:["accessUpdate","accessRead"],components:{"pengajuan-items":n.a,"rpbj-page":r.a},data:function(){return{curStep:4,rpbjSetted:!1}},computed:{isRejected:function(){return null!=this.pengajuan.rpbj&&(null!=this.pengajuan.rpbj.penolakan_renev||null!=this.pengajuan.rpbj.penolakan_manager)},catatanPenolakan:function(){return null!=this.pengajuan.rpbj?null!=this.pengajuan.rpbj.penolakan_renev?this.pengajuan.rpbj.penolakan_renev:this.pengajuan.rpbj.penolakan_manager:""},isWriteable:function(){return!(3!=this.pengajuan.status||!this.accessUpdate)},pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(e){this.$store.commit("pengajuan/setOneData",e)}},rpbName:function(){return 0==this.pengajuan.jenis_pekerjaan?"RPB":"RPJ"}},created:function(){},methods:{nextStep:function(){var e=this,a={id:this.pengajuan.id,status:this.curStep};this.$store.dispatch("pengajuan/updatePengajuan",a).then(function(a){e.Web.showAlert({text:"Pengajuan berhasil diproses selanjutnya"}),e.$router.push({name:"pengajuan"})}).catch(function(a){e.Web.showAlert({text:"Save data failed : "+a.message,type:"warning"})})},onRpbjSetted:function(e){console.log("from step 4",e),this.rpbjSetted=!0}}},o=t("KHd+"),i=Object(o.a)(s,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("b-card",{attrs:{"no-body":""}},[t("b-card-header",{staticClass:"with-elements"},[t("div",{staticClass:"card-header-title mr-2"},[t("h4",[e._v("Step 4")]),e._v(" "),t("span",[e._v("Update referensi item & tambah "+e._s(e.rpbName)+" oleh Enjin")])]),e._v(" "),3!=e.pengajuan.status?t("div",{staticClass:"card-header-elements ml-md-auto"},[t("b-badge",{attrs:{variant:"outline-danger"}},[e._v("Read Only")])],1):e._e()]),e._v(" "),e.isRejected?t("b-card-body",[t("b-alert",{attrs:{show:"",variant:"dark-warning"}},[e._v("\n      Alasan Penolakan : "+e._s(e.catatanPenolakan)+"\n    ")])],1):e._e(),e._v(" "),t("pengajuan-items",{attrs:{step:e.curStep,accessRead:e.accessRead,accessUpdate:e.accessUpdate}}),e._v(" "),t("rpbj-page",{attrs:{step:e.curStep,isWriteable:e.isWriteable},on:{onRpbjLoaded:e.onRpbjSetted}}),e._v(" "),t("b-card-footer",{staticClass:"text-right"},[t("b-btn",{staticClass:"btn btn-success btn-sm",attrs:{disabled:!(e.isWriteable&&1==e.pengajuan.evaluasi_final&&e.rpbjSetted)},on:{click:e.nextStep}},[e._v("Simpan dan teruskan proses")])],1)],1)},[],!1,null,null,null);a.default=i.exports}}]);