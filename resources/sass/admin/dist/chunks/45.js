(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{xWyS:function(a,t,e){"use strict";e.r(t);var s=e("S2uq"),n=e("eHvb"),i=e("tyoB"),r=e("0pXA"),o={name:"pengajuan-step-8",props:["accessUpdate","accessRead"],components:{substep71:s.a,substep72:n.a,substep73:i.a,substep74:r.a},data:function(){return{curStep:8,tabIndex:0,rejectform:{status:7,catatan_penolakan:""}}},computed:{isWriteable:function(){return!(10!=this.pengajuan.status||!this.accessUpdate)},pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(a){this.$store.commit("pengajuan/setOneData",a)}}},created:function(){this.pengajuan.status>=9?this.changeTab(4):this.pengajuan.status>=8?this.changeTab(3):this.pengajuan.status>=7?this.changeTab(2):this.pengajuan.status>=6&&this.changeTab(1)},methods:{changeTab:function(a){this.tabIndex=a},rejectStep:function(){this.$bvModal.show("penolakan-modals-form-step8")},submitReject:function(){var a=this;if(""==this.rejectform.catatan_penolakan)return this.Web.showAlert({text:"Alasan penolakan harus diisi",type:"warning"}),!1;this.$store.dispatch("pengajuan/updatePengajuan",{id:this.pengajuan.id,status:this.rejectform.status,catatan_penolakan:this.rejectform.catatan_penolakan}).then(function(t){a.Web.showAlert({text:"Pengajuan berhasil ditolak"}),a.$router.push({name:"pengajuan"})}).catch(function(t){a.Web.showAlert({text:"Tolak dokumen gagal : "+t.message,type:"warning"}),a.$bvModal.hide("penolakan-modals-form-step6")})},nextStep:function(){var a=this;this.pengajuan.status;var t={id:this.pengajuan.id,status:11};this.$store.dispatch("pengajuan/updatePengajuan",t).then(function(t){a.Web.showAlert({text:"Pengajuan berhasil diproses selanjutnya"}),a.$router.push({name:"pengajuan"})}).catch(function(t){a.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})}}},c=e("KHd+"),l=Object(c.a)(o,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("b-card",{attrs:{"no-body":""}},[e("b-card-header",{staticClass:"with-elements"},[e("div",{staticClass:"card-header-title mr-2"},[e("h4",[a._v("Step 8")]),a._v(" "),e("div",[e("span",[a._v("Approval & Evaluasi dokumen Laksdan oleh Manager Unit")]),a._v(" "),a.pengajuan.approval&&a.pengajuan.approval.spk_manager?e("p",[e("i",[a._v("\n                  Disetujui oleh \n                  "),e("b",[a._v("\n                      "+a._s(a.pengajuan.approval.spk_manager.user_data.name)+" - \n                      "+a._s(a.pengajuan.approval.spk_manager.user_data.jabatan.nama)+"\n                  ")]),a._v(" \n                  pada "+a._s(a.pengajuan.approval.spk_manager.tanggal)+"\n              ")])]):a._e()])]),a._v(" "),10!=a.pengajuan.status?e("div",{staticClass:"card-header-elements ml-md-auto"},[e("b-badge",{attrs:{variant:"outline-danger"}},[a._v("Read Only")])],1):a._e()]),a._v(" "),e("b-card",{staticClass:"bg-light",attrs:{"no-body":""}},[e("b-tabs",{staticClass:"nav-tabs-top",attrs:{card:""},model:{value:a.tabIndex,callback:function(t){a.tabIndex=t},expression:"tabIndex"}},[e("b-tab",{staticClass:"pt-2 pl-3 pr-3",attrs:{title:"HPS"}},[e("substep71",{attrs:{noAction:!0,curStep:a.curStep,accessUpdate:!1,isWriteable:!1,accessRead:a.accessRead},on:{changeTab:a.changeTab}})],1),a._v(" "),e("b-tab",{attrs:{title:"Evaluasi Mitra"}},[e("substep72",{attrs:{noAction:!0,curStep:a.curStep,accessUpdate:!1,isWriteable:!1,accessRead:a.accessRead},on:{changeTab:a.changeTab}})],1),a._v(" "),e("b-tab",{attrs:{title:"Negosiasi"}},[e("substep73",{attrs:{noAction:!0,curStep:a.curStep,accessUpdate:!1,isWriteable:!1,accessRead:a.accessRead},on:{changeTab:a.changeTab}})],1),a._v(" "),e("b-tab",{attrs:{title:"Spk"}},[e("substep74",{attrs:{noAction:!0,curStep:a.curStep,accessUpdate:!0,isWriteable:!1,accessRead:a.accessRead},on:{changeTab:a.changeTab}})],1)],1)],1),a._v(" "),e("b-card-footer",{staticClass:"text-right"},[e("b-btn",{staticClass:"btn float-left btn-warning btn-sm mr-2",attrs:{disabled:!a.isWriteable},on:{click:a.rejectStep}},[e("i",{staticClass:"ion ion-md-close"}),a._v(" Tolak Dokumen\n      ")]),a._v(" "),e("b-btn",{staticClass:"btn btn-success btn-sm",attrs:{disabled:!(a.isWriteable&&a.pengajuan.spk.doc_upload)},on:{click:a.nextStep}},[a._v("Selesai dan Teruskan proses")])],1),a._v(" "),a.isWriteable?[e("b-modal",{attrs:{id:"penolakan-modals-form-step8",size:"sm"},on:{ok:a.submitReject}},[e("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[a._v("\n              Form / "),e("span",{staticClass:"font-weight-light"},[a._v("Tolak Dokumen")])]),a._v(" "),e("b-form-group",{attrs:{label:"Tolak dokumen","label-align-md":"right","label-class":"pr-md-2","label-cols-md":3}},[e("b-select",{staticClass:"w-auto",attrs:{options:[{text:"HPS",value:6},{text:"Evaluasi Mitra",value:7},{text:"Negosiasi",value:8},{text:"SPK",value:9}],disabled:!a.isWriteable},model:{value:a.rejectform.status,callback:function(t){a.$set(a.rejectform,"status",t)},expression:"rejectform.status"}})],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Alasan Penolakan"}},[e("b-textarea",{attrs:{placeholder:"Alasan Penolakan"},model:{value:a.rejectform.catatan_penolakan,callback:function(t){a.$set(a.rejectform,"catatan_penolakan","string"==typeof t?t.trim():t)},expression:"rejectform.catatan_penolakan"}})],1)],1)],1)]:a._e()],2)},[],!1,null,null,null);t.default=l.exports}}]);