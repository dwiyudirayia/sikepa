(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"/DBy":function(e,t,a){"use strict";a.r(t);var n=a("5eju"),o=a("+TlC"),r=a("UBhW"),i={name:"pengajuan-step-5",props:["accessUpdate","accessRead"],components:{"pengajuan-items":o.a,"rpbj-page":r.a,"download-notdin":n.a},data:function(){return{curStep:5,rpbjSetted:!1,rejectform:{status:3,penolakan:""}}},computed:{isWriteable:function(){return!(4!=this.pengajuan.status||!this.accessUpdate)},isDocApproved:function(){return this.pengajuan.rpbj&&0!=this.pengajuan.rpbj.renev_id&&null==this.pengajuan.rpbj.penolakan_renev},isDocRejected:function(){return this.pengajuan.rpbj&&0!=this.pengajuan.rpbj.renev_id&&null!=this.pengajuan.rpbj.penolakan_renev},pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(e){this.$store.commit("pengajuan/setOneData",e)}},isApproved:function(){return this.pengajuan.approval&&this.pengajuan.approval.rpbj_renev}},methods:{onRpbjSetted:function(e){this.rpbjSetted=!0},nextStep:function(){var e=this,t={id:this.pengajuan.id,status:this.curStep};this.$store.dispatch("pengajuan/updatePengajuan",t).then(function(t){e.Web.showAlert({text:"Pengajuan berhasil diproses selanjutnya"}),e.$router.push({name:"pengajuan"})}).catch(function(t){e.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})},approveDoc:function(){var e=this;this.$store.dispatch("pengajuan/approvalRpbj",{pId:this.pengajuan.id,isManager:!1,isApprove:!0}).then(function(t){e.Web.showAlert({text:"Pengajuan berhasil diterima"})}).catch(function(t){e.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})},rejectStep:function(){this.$bvModal.show("penolakan-modals-form-step5")},submitReject:function(){var e=this;if(""==this.rejectform.penolakan)return this.Web.showAlert({text:"Alasan penolakan harus diisi",type:"warning"}),!1;this.$store.dispatch("pengajuan/updatePengajuan",{id:this.pengajuan.id,status:this.rejectform.status}).then(function(t){e.$store.dispatch("pengajuan/approvalRpbj",{pId:e.pengajuan.id,isManager:!1,isApprove:!1,penolakan:e.rejectform.penolakan}).then(function(t){e.Web.showAlert({text:"Dokumen berhasil ditolak"}),e.$router.push({name:"pengajuan"})}).catch(function(t){e.Web.showAlert({text:"Tolak dokumen gagal : "+t.message,type:"warning"}),e.$bvModal.hide("penolakan-modals-form-step5")})}).catch(function(t){e.Web.showAlert({text:"Tolak dokumen gagal : "+t.message,type:"warning"}),e.$bvModal.hide("penolakan-modals-form-step5")})}}},s=a("KHd+"),l=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"with-elements"},[a("div",{staticClass:"card-header-title mr-2"},[a("h4",[e._v("Step 5")]),e._v(" "),a("div",[a("span",[e._v("Approval dokumen Enjin oleh Renev")]),e._v(" "),e.isApproved?a("p",[a("i",[e._v("\n                  Disetujui oleh \n                  "),a("b",[e._v("\n                      "+e._s(e.pengajuan.approval.rpbj_renev.user_data.name)+" - \n                      "+e._s(e.pengajuan.approval.rpbj_renev.user_data.jabatan.nama)+"\n                  ")]),e._v(" \n                  pada "+e._s(e.pengajuan.approval.rpbj_renev.tanggal)+"\n              ")])]):e._e()])]),e._v(" "),4!=e.pengajuan.status?a("div",{staticClass:"card-header-elements ml-md-auto"},[a("b-badge",{attrs:{variant:"outline-danger"}},[e._v("Read Only")])],1):e._e()]),e._v(" "),a("pengajuan-items",{attrs:{step:e.curStep,accessRead:e.accessRead,accessUpdate:e.accessUpdate}}),e._v(" "),a("rpbj-page",{attrs:{step:e.curStep,isWriteable:!1},on:{onRpbjLoaded:e.onRpbjSetted}}),e._v(" "),a("b-card-body",[a("b-btn",{staticClass:"btn btn-success btn-sm mr-2",attrs:{disabled:!(e.isWriteable&&!e.isDocApproved&&!e.isDocRejected)},on:{click:e.approveDoc}},[a("i",{staticClass:"ion ion-md-checkmark"}),e._v(" Terima Dokumen\n      ")]),e._v(" "),a("b-btn",{staticClass:"btn btn-warning btn-sm mr-2",attrs:{disabled:!(e.isWriteable&&!e.isDocApproved&&!e.isDocRejected)},on:{click:e.rejectStep}},[a("i",{staticClass:"ion ion-md-close"}),e._v(" Tolak Dokumen\n      ")])],1),e._v(" "),a("b-card-footer",{staticClass:"text-right"},[a("b-btn",{staticClass:"btn btn-success btn-sm",attrs:{disabled:!(e.isWriteable&&e.isDocApproved)},on:{click:e.nextStep}},[e._v("Simpan dan teruskan proses")])],1),e._v(" "),e.isWriteable?[a("b-modal",{attrs:{id:"penolakan-modals-form-step5",size:"sm"},on:{ok:e.submitReject}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[e._v("\n              Form / "),a("span",{staticClass:"font-weight-light"},[e._v("Tolak Dokumen")])]),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Alasan Penolakan"}},[a("b-textarea",{attrs:{placeholder:"Alasan Penolakan"},model:{value:e.rejectform.penolakan,callback:function(t){e.$set(e.rejectform,"penolakan","string"==typeof t?t.trim():t)},expression:"rejectform.penolakan"}})],1)],1)],1)]:e._e()],2)},[],!1,null,null,null);t.default=l.exports},"5eju":function(e,t,a){"use strict";var n=a("ta7f"),o={name:"download-notdin",props:["notdinRef","notdinCaption","enable","allowEdit"],components:{Datepicker:a("+jP+").a},validations:{form:{nomor:{required:Object(n.requiredIf)(function(e){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},tanggal:{required:n.required},sifat:{required:Object(n.requiredIf)(function(e){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},perihal:{required:Object(n.requiredIf)(function(e){return"manrenev"==this.notdinRef||"manlaksdan"==this.notdinRef})}}},data:function(){return{form:{nomor:"",tanggal:"",sifat:"",perihal:""}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(e){this.$store.commit("pengajuan/setOneData",e)}}},created:function(){var e=this;this.$store.dispatch("pengajuan/getNotdin",{notdinREf:this.notdinRef,pId:this.pengajuan.id}).then(function(t){"rab"==e.notdinRef?(e.form.nomor=t.no_notdin,e.form.tanggal=null!=t.tgl_notdin?new Date(t.tgl_notdin):new Date):(e.form.nomor=t.nomor,e.form.tanggal=new Date(t.tanggal),""==t.perihal?e.form.perihal=t.perihal:e.form.perihal=e.pengajuan.nama_pekerjaan,"manrenev"!=e.notdinRef&&"manlaksdan"!=e.notdinRef||(t.sifat?e.form.sifat=t.sifat:e.form.sifat="Segera"))}).catch(function(t){console.log("load notdin "+e.notdinRef+" error : ",t),"manrenev"==e.notdinRef?e.form.perihal="Tindaklanjut Proses Evaluasi RAB":"manlaksdan"==e.notdinRef&&(e.form.perihal="Tindaklanjut Proses Pengadaan"),e.form.tanggal=new Date,e.form.sifat="Segera"})},methods:{showForm:function(e){this.$bvModal.show("notdin-modals-"+this.notdinRef)},formSubmitted:function(e){var t=this;if(e.preventDefault(),this.allowEdit){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.$store.dispatch("pengajuan/saveNotdin",{notdinRef:this.notdinRef,pId:this.pengajuan.id,data:this.form}).then(function(e){t.Web.showAlert({text:"Data saved"}),t.$bvModal.hide("notdin-modals-"+t.notdinRef),t.download("notdin_"+t.notdinRef+"/"+t.pengajuan.id,"notdin_"+t.notdinRef+".docx")}).catch(function(e){t.Web.showAlert({text:"Save data failed : "+e.message,type:"warning"})})}else this.$bvModal.hide("notdin-modals-"+this.notdinRef),this.download("notdin_"+this.notdinRef+"/"+this.pengajuan.id,"notdin_"+this.notdinRef+".docx")}}},r=a("KHd+"),i=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("b-btn",{staticClass:"btn btn-info btn-sm",attrs:{disabled:!e.enable},on:{click:e.showForm}},[e._v("Unduh "+e._s(e.notdinCaption))]),e._v(" "),e.enable?[a("b-modal",{attrs:{id:"notdin-modals-"+e.notdinRef,size:"sm"},on:{ok:e.formSubmitted,hidden:e.$v.$reset}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[e._v("\n        Form /\n        "),a("span",{staticClass:"font-weight-light"},[e._v(e._s(e.notdinCaption))]),e._v(" "),a("br")]),e._v(" "),"rab"!=e.notdinRef&&"renevman"!=e.notdinRef?a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor"}},[a("b-input",{attrs:{state:e.$v.form.nomor.$error?"invalid":"",placeholder:"Nomor Nota Dinas",disabled:!e.allowEdit},on:{blur:function(t){return e.$v.form.nomor.$touch()}},model:{value:e.form.nomor,callback:function(t){e.$set(e.form,"nomor","string"==typeof t?t.trim():t)},expression:"form.nomor"}}),e._v(" "),a("invalid-tooltip",{attrs:{inputItem:e.$v.form.nomor,fieldName:"Nomor"}})],1)],1):e._e(),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal"}},[a("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0,disabled:!e.allowEdit},model:{value:e.form.tanggal,callback:function(t){e.$set(e.form,"tanggal",t)},expression:"form.tanggal"}}),e._v(" "),a("invalid-tooltip",{attrs:{inputItem:e.$v.form.tanggal,fieldName:"Tanggal"}})],1)],1),e._v(" "),"rab"!=e.notdinRef&&"renevman"!=e.notdinRef?a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sifat"}},[a("b-input",{attrs:{state:e.$v.form.sifat.$error?"invalid":"",placeholder:"Sifat",disabled:!e.allowEdit},on:{blur:function(t){return e.$v.form.sifat.$touch()}},model:{value:e.form.sifat,callback:function(t){e.$set(e.form,"sifat","string"==typeof t?t.trim():t)},expression:"form.sifat"}}),e._v(" "),a("invalid-tooltip",{attrs:{inputItem:e.$v.form.sifat,fieldName:"Sifat"}})],1)],1):e._e(),e._v(" "),"manrenev"==e.notdinRef||"manlaksdan"==e.notdinRef?a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Perihal"}},[a("b-input",{attrs:{state:e.$v.form.perihal.$error?"invalid":"",placeholder:"Perihal",disabled:!e.allowEdit},on:{blur:function(t){return e.$v.form.perihal.$touch()}},model:{value:e.form.perihal,callback:function(t){e.$set(e.form,"perihal","string"==typeof t?t.trim():t)},expression:"form.perihal"}}),e._v(" "),a("invalid-tooltip",{attrs:{inputItem:e.$v.form.perihal,fieldName:"Perihal"}})],1)],1):e._e()],1)]:e._e()],2)},[],!1,null,null,null);t.a=i.exports},UBhW:function(e,t,a){"use strict";var n=a("ta7f"),o={name:"prbj-page",props:["isWriteable","step"],components:{Datepicker:a("+jP+").a},data:function(){return{curStep:4,form:{nomor:"",tanggal:moment().format("YYYY-MM-DD"),kebutuhan:0,metode:0,sumber_anggaran:0,nomor_sumber:""},rpbjSetted:!1}},validations:{form:{tanggal:{required:n.required},kebutuhan:{required:n.required},metode:{required:n.required},sumber_anggaran:{required:n.required},nomor_sumber:{required:n.required}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(e){this.$store.commit("pengajuan/setOneData",e)}},rpbName:function(){return 0==this.pengajuan.jenis_pekerjaan?"RPB":"RPJ"}},watch:{"form.sumber_anggaran":function(e){2==e&&""==this.form.nomor_sumber&&(this.form.nomor_sumber=this.pengajuan.prk.no_prk)}},created:function(){null!=this.pengajuan.rpbj?(this.form={nomor:this.pengajuan.rpbj.nomor,tanggal:new Date(this.pengajuan.rpbj.tanggal),kebutuhan:this.pengajuan.rpbj.kebutuhan,metode:this.pengajuan.rpbj.metode,sumber_anggaran:this.pengajuan.rpbj.sumber_anggaran,nomor_sumber:this.pengajuan.rpbj.nomor_sumber},this.$emit("onRpbjLoaded",!0),this.rpbjSetted=!0):(this.form.nomor="[AUTO GENERATED]",this.form.tanggal=new Date)},methods:{submitRpbj:function(e){var t=this;if(e.preventDefault(),this.isWriteable){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.form.p_id=this.pengajuan.id,this.$store.dispatch("pengajuan/saveRpbj",this.form).then(function(e){t.rpbjSetted=!0,t.$emit("onRpbjLoaded",!0),t.Web.showAlert({text:"Data saved"}),t.download("rpbj/"+t.pengajuan.id,t.rpbName+".docx")}).catch(function(e){t.Web.showAlert({text:"Save data failed : "+e.message,type:"warning"})})}else this.download("rpbj/"+this.pengajuan.id,this.rpbName+".docx")}}},r=a("KHd+"),i=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card-body",[a("h5",[e._v("\n    Form /\n    "),a("span",{staticClass:"font-weight-light"},[e._v(e._s(e.rpbName))])]),e._v(" "),a("b-form-row",[e.rpbjSetted?a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor","label-align-md":"right","label-cols-md":2}},[a("b-input",{attrs:{disabled:!0},model:{value:e.form.nomor,callback:function(t){e.$set(e.form,"nomor","string"==typeof t?t.trim():t)},expression:"form.nomor"}})],1):e._e()],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal","label-align-md":"right","label-cols-md":2}},[a("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!1,disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final)},model:{value:e.form.tanggal,callback:function(t){e.$set(e.form,"tanggal",t)},expression:"form.tanggal"}})],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Kebutuhan","label-align-md":"right","label-cols-md":2}},[a("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"Rutin",1:"Non Rutin",2:"Investasi"}},model:{value:e.form.kebutuhan,callback:function(t){e.$set(e.form,"kebutuhan",t)},expression:"form.kebutuhan"}})],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Metode","label-align-md":"right","label-cols-md":2}},[a("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"Pelelangan",1:"Penunjukkan Langsung",2:"Pengadaan Langsung"}},model:{value:e.form.metode,callback:function(t){e.$set(e.form,"metode",t)},expression:"form.metode"}})],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sumber Anggaran","label-align-md":"right","label-cols-md":2}},[a("b-form-select",{attrs:{disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final),options:{0:"SKKO",1:"SKKI",2:"PRK"}},model:{value:e.form.sumber_anggaran,callback:function(t){e.$set(e.form,"sumber_anggaran",t)},expression:"form.sumber_anggaran"}})],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor Sumber","label-align-md":"right","label-cols-md":2}},[a("b-input",{attrs:{state:e.$v.form.nomor_sumber.$error?"invalid":"",placeholder:"Nomor Sumber",disabled:!(e.isWriteable&&e.pengajuan.evaluasi_final)},on:{blur:function(t){return e.$v.form.nomor_sumber.$touch()}},model:{value:e.form.nomor_sumber,callback:function(t){e.$set(e.form,"nomor_sumber","string"==typeof t?t.trim():t)},expression:"form.nomor_sumber"}}),e._v(" "),a("invalid-tooltip",{attrs:{inputItem:e.$v.form.nomor_sumber,fieldName:"Nomor Sumber"}})],1)],1),e._v(" "),a("div",{staticClass:"text-right"},[a("b-btn",{staticClass:"btn btn-secondary btn-sm mr-2",attrs:{disabled:!e.pengajuan.evaluasi_final},on:{click:e.submitRpbj}},[a("i",{staticClass:"ion ion-md-cloud-download"}),e._v("\n      "+e._s(e.isWriteable?"Isi dan ":"")+" Unduh dokumen "+e._s(e.rpbName)+"\n    ")])],1)],1)},[],!1,null,null,null);t.a=i.exports}}]);