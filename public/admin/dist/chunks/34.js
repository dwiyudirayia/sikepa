(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"5eju":function(a,t,e){"use strict";var n=e("ta7f"),o={name:"download-notdin",props:["notdinRef","notdinCaption","enable","allowEdit"],components:{Datepicker:e("+jP+").a},validations:{form:{nomor:{required:Object(n.requiredIf)(function(a){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},tanggal:{required:n.required},sifat:{required:Object(n.requiredIf)(function(a){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},perihal:{required:Object(n.requiredIf)(function(a){return"manrenev"==this.notdinRef||"manlaksdan"==this.notdinRef})}}},data:function(){return{form:{nomor:"",tanggal:"",sifat:"",perihal:""}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(a){this.$store.commit("pengajuan/setOneData",a)}}},created:function(){var a=this;this.$store.dispatch("pengajuan/getNotdin",{notdinREf:this.notdinRef,pId:this.pengajuan.id}).then(function(t){"rab"==a.notdinRef?(a.form.nomor=t.no_notdin,a.form.tanggal=null!=t.tgl_notdin?new Date(t.tgl_notdin):new Date):(a.form.nomor=t.nomor,a.form.tanggal=new Date(t.tanggal),""==t.perihal?a.form.perihal=t.perihal:a.form.perihal=a.pengajuan.nama_pekerjaan,"manrenev"!=a.notdinRef&&"manlaksdan"!=a.notdinRef||(t.sifat?a.form.sifat=t.sifat:a.form.sifat="Segera"))}).catch(function(t){console.log("load notdin "+a.notdinRef+" error : ",t),"manrenev"==a.notdinRef?a.form.perihal="Tindaklanjut Proses Evaluasi RAB":"manlaksdan"==a.notdinRef&&(a.form.perihal="Tindaklanjut Proses Pengadaan"),a.form.tanggal=new Date,a.form.sifat="Segera"})},methods:{showForm:function(a){this.$bvModal.show("notdin-modals-"+this.notdinRef)},formSubmitted:function(a){var t=this;if(a.preventDefault(),this.allowEdit){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.$store.dispatch("pengajuan/saveNotdin",{notdinRef:this.notdinRef,pId:this.pengajuan.id,data:this.form}).then(function(a){t.Web.showAlert({text:"Data saved"}),t.$bvModal.hide("notdin-modals-"+t.notdinRef),t.download("notdin_"+t.notdinRef+"/"+t.pengajuan.id,"notdin_"+t.notdinRef+".docx")}).catch(function(a){t.Web.showAlert({text:"Save data failed : "+a.message,type:"warning"})})}else this.$bvModal.hide("notdin-modals-"+this.notdinRef),this.download("notdin_"+this.notdinRef+"/"+this.pengajuan.id,"notdin_"+this.notdinRef+".docx")}}},r=e("KHd+"),i=Object(r.a)(o,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("span",[e("b-btn",{staticClass:"btn btn-info btn-sm",attrs:{disabled:!a.enable},on:{click:a.showForm}},[a._v("Unduh "+a._s(a.notdinCaption))]),a._v(" "),a.enable?[e("b-modal",{attrs:{id:"notdin-modals-"+a.notdinRef,size:"sm"},on:{ok:a.formSubmitted,hidden:a.$v.$reset}},[e("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[a._v("\n        Form /\n        "),e("span",{staticClass:"font-weight-light"},[a._v(a._s(a.notdinCaption))]),a._v(" "),e("br")]),a._v(" "),"rab"!=a.notdinRef&&"renevman"!=a.notdinRef?e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor"}},[e("b-input",{attrs:{state:a.$v.form.nomor.$error?"invalid":"",placeholder:"Nomor Nota Dinas",disabled:!a.allowEdit},on:{blur:function(t){return a.$v.form.nomor.$touch()}},model:{value:a.form.nomor,callback:function(t){a.$set(a.form,"nomor","string"==typeof t?t.trim():t)},expression:"form.nomor"}}),a._v(" "),e("invalid-tooltip",{attrs:{inputItem:a.$v.form.nomor,fieldName:"Nomor"}})],1)],1):a._e(),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal"}},[e("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0,disabled:!a.allowEdit},model:{value:a.form.tanggal,callback:function(t){a.$set(a.form,"tanggal",t)},expression:"form.tanggal"}}),a._v(" "),e("invalid-tooltip",{attrs:{inputItem:a.$v.form.tanggal,fieldName:"Tanggal"}})],1)],1),a._v(" "),"rab"!=a.notdinRef&&"renevman"!=a.notdinRef?e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sifat"}},[e("b-input",{attrs:{state:a.$v.form.sifat.$error?"invalid":"",placeholder:"Sifat",disabled:!a.allowEdit},on:{blur:function(t){return a.$v.form.sifat.$touch()}},model:{value:a.form.sifat,callback:function(t){a.$set(a.form,"sifat","string"==typeof t?t.trim():t)},expression:"form.sifat"}}),a._v(" "),e("invalid-tooltip",{attrs:{inputItem:a.$v.form.sifat,fieldName:"Sifat"}})],1)],1):a._e(),a._v(" "),"manrenev"==a.notdinRef||"manlaksdan"==a.notdinRef?e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Perihal"}},[e("b-input",{attrs:{state:a.$v.form.perihal.$error?"invalid":"",placeholder:"Perihal",disabled:!a.allowEdit},on:{blur:function(t){return a.$v.form.perihal.$touch()}},model:{value:a.form.perihal,callback:function(t){a.$set(a.form,"perihal","string"==typeof t?t.trim():t)},expression:"form.perihal"}}),a._v(" "),e("invalid-tooltip",{attrs:{inputItem:a.$v.form.perihal,fieldName:"Perihal"}})],1)],1):a._e()],1)]:a._e()],2)},[],!1,null,null,null);t.a=i.exports},UBhW:function(a,t,e){"use strict";var n=e("ta7f"),o={name:"prbj-page",props:["isWriteable","step"],components:{Datepicker:e("+jP+").a},data:function(){return{curStep:4,form:{nomor:"",tanggal:moment().format("YYYY-MM-DD"),kebutuhan:0,metode:0,sumber_anggaran:0,nomor_sumber:""},rpbjSetted:!1}},validations:{form:{tanggal:{required:n.required},kebutuhan:{required:n.required},metode:{required:n.required},sumber_anggaran:{required:n.required},nomor_sumber:{required:n.required}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(a){this.$store.commit("pengajuan/setOneData",a)}},rpbName:function(){return 0==this.pengajuan.jenis_pekerjaan?"RPB":"RPJ"}},watch:{"form.sumber_anggaran":function(a){2==a&&""==this.form.nomor_sumber&&(this.form.nomor_sumber=this.pengajuan.prk.no_prk)}},created:function(){null!=this.pengajuan.rpbj?(this.form={nomor:this.pengajuan.rpbj.nomor,tanggal:new Date(this.pengajuan.rpbj.tanggal),kebutuhan:this.pengajuan.rpbj.kebutuhan,metode:this.pengajuan.rpbj.metode,sumber_anggaran:this.pengajuan.rpbj.sumber_anggaran,nomor_sumber:this.pengajuan.rpbj.nomor_sumber},this.$emit("onRpbjLoaded",!0),this.rpbjSetted=!0):(this.form.nomor="[AUTO GENERATED]",this.form.tanggal=new Date)},methods:{submitRpbj:function(a){var t=this;if(a.preventDefault(),this.isWriteable){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.form.p_id=this.pengajuan.id,this.$store.dispatch("pengajuan/saveRpbj",this.form).then(function(a){t.rpbjSetted=!0,t.$emit("onRpbjLoaded",!0),t.Web.showAlert({text:"Data saved"}),t.download("rpbj/"+t.pengajuan.id,t.rpbName+".docx")}).catch(function(a){t.Web.showAlert({text:"Save data failed : "+a.message,type:"warning"})})}else this.download("rpbj/"+this.pengajuan.id,this.rpbName+".docx")}}},r=e("KHd+"),i=Object(r.a)(o,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("b-card-body",[e("h5",[a._v("\n    Form /\n    "),e("span",{staticClass:"font-weight-light"},[a._v(a._s(a.rpbName))])]),a._v(" "),e("b-form-row",[a.rpbjSetted?e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor","label-align-md":"right","label-cols-md":2}},[e("b-input",{attrs:{disabled:!0},model:{value:a.form.nomor,callback:function(t){a.$set(a.form,"nomor","string"==typeof t?t.trim():t)},expression:"form.nomor"}})],1):a._e()],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal","label-align-md":"right","label-cols-md":2}},[e("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!1,disabled:!(a.isWriteable&&a.pengajuan.evaluasi_final)},model:{value:a.form.tanggal,callback:function(t){a.$set(a.form,"tanggal",t)},expression:"form.tanggal"}})],1)],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Kebutuhan","label-align-md":"right","label-cols-md":2}},[e("b-form-select",{attrs:{disabled:!(a.isWriteable&&a.pengajuan.evaluasi_final),options:{0:"Rutin",1:"Non Rutin",2:"Investasi"}},model:{value:a.form.kebutuhan,callback:function(t){a.$set(a.form,"kebutuhan",t)},expression:"form.kebutuhan"}})],1)],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Metode","label-align-md":"right","label-cols-md":2}},[e("b-form-select",{attrs:{disabled:!(a.isWriteable&&a.pengajuan.evaluasi_final),options:{0:"Pelelangan",1:"Penunjukkan Langsung",2:"Pengadaan Langsung"}},model:{value:a.form.metode,callback:function(t){a.$set(a.form,"metode",t)},expression:"form.metode"}})],1)],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sumber Anggaran","label-align-md":"right","label-cols-md":2}},[e("b-form-select",{attrs:{disabled:!(a.isWriteable&&a.pengajuan.evaluasi_final),options:{0:"SKKO",1:"SKKI",2:"PRK"}},model:{value:a.form.sumber_anggaran,callback:function(t){a.$set(a.form,"sumber_anggaran",t)},expression:"form.sumber_anggaran"}})],1)],1),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor Sumber","label-align-md":"right","label-cols-md":2}},[e("b-input",{attrs:{state:a.$v.form.nomor_sumber.$error?"invalid":"",placeholder:"Nomor Sumber",disabled:!(a.isWriteable&&a.pengajuan.evaluasi_final)},on:{blur:function(t){return a.$v.form.nomor_sumber.$touch()}},model:{value:a.form.nomor_sumber,callback:function(t){a.$set(a.form,"nomor_sumber","string"==typeof t?t.trim():t)},expression:"form.nomor_sumber"}}),a._v(" "),e("invalid-tooltip",{attrs:{inputItem:a.$v.form.nomor_sumber,fieldName:"Nomor Sumber"}})],1)],1),a._v(" "),e("div",{staticClass:"text-right"},[e("b-btn",{staticClass:"btn btn-secondary btn-sm mr-2",attrs:{disabled:!a.pengajuan.evaluasi_final},on:{click:a.submitRpbj}},[e("i",{staticClass:"ion ion-md-cloud-download"}),a._v("\n      "+a._s(a.isWriteable?"Isi dan ":"")+" Unduh dokumen "+a._s(a.rpbName)+"\n    ")])],1)],1)},[],!1,null,null,null);t.a=i.exports},vYKW:function(a,t,e){"use strict";e.r(t);var n=e("5eju"),o=e("+TlC"),r=e("UBhW"),i={name:"pengajuan-step-6",props:["accessUpdate","accessRead"],components:{"pengajuan-items":o.a,"rpbj-page":r.a,"download-notdin":n.a},data:function(){return{curStep:6,rpbjSetted:!1,rejectform:{status:3,penolakan:""}}},computed:{isWriteable:function(){return!(5!=this.pengajuan.status||!this.accessUpdate)},isDocApproved:function(){return this.pengajuan.rpbj&&0!=this.pengajuan.rpbj.manager_id&&null==this.pengajuan.rpbj.penolakan_manager},isDocRejected:function(){return this.pengajuan.rpbj&&0!=this.pengajuan.rpbj.manager_id&&null!=this.pengajuan.rpbj.penolakan_manager},isNotdinCreated:function(){return null!=this.pengajuan.notdin_man_laksdan},pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(a){this.$store.commit("pengajuan/setOneData",a)}}},methods:{onRpbjSetted:function(a){this.rpbjSetted=!0},nextStep:function(){var a=this,t={id:this.pengajuan.id,status:this.curStep};this.$store.dispatch("pengajuan/updatePengajuan",t).then(function(t){a.Web.showAlert({text:"Pengajuan berhasil diproses selanjutnya"}),a.$router.push({name:"pengajuan"})}).catch(function(t){a.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})},approveDoc:function(){var a=this;this.$store.dispatch("pengajuan/approvalRpbj",{pId:this.pengajuan.id,isManager:!0,isApprove:!0}).then(function(t){a.Web.showAlert({text:"Pengajuan berhasil diterima"})}).catch(function(t){a.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})},rejectStep:function(){this.$bvModal.show("penolakan-modals-form-step6")},submitReject:function(){var a=this;if(""==this.rejectform.penolakan)return this.Web.showAlert({text:"Alasan penolakan harus diisi",type:"warning"}),!1;this.$store.dispatch("pengajuan/updatePengajuan",{id:this.pengajuan.id,status:this.rejectform.status}).then(function(t){a.$store.dispatch("pengajuan/approvalRpbj",{pId:a.pengajuan.id,isManager:!0,isApprove:!1,penolakan:a.rejectform.penolakan}).then(function(t){a.Web.showAlert({text:"Dokumen berhasil ditolak"}),a.$router.push({name:"pengajuan"})}).catch(function(t){a.Web.showAlert({text:"Tolak dokumen gagal : "+t.message,type:"warning"}),a.$bvModal.hide("penolakan-modals-form-step6")})}).catch(function(t){a.Web.showAlert({text:"Tolak dokumen gagal : "+t.message,type:"warning"}),a.$bvModal.hide("penolakan-modals-form-step6")})}}},s=e("KHd+"),l=Object(s.a)(i,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("b-card",{attrs:{"no-body":""}},[e("b-card-header",{staticClass:"with-elements"},[e("div",{staticClass:"card-header-title mr-2"},[e("h4",[a._v("Step 6")]),a._v(" "),e("div",[e("span",[a._v("Approval dokumen Enjin oleh Manager Unit")]),a._v(" "),a.pengajuan.approval&&a.pengajuan.approval.rpbj_manager?e("p",[e("i",[a._v("\n                  Dibuat oleh \n                  "),e("b",[a._v("\n                      "+a._s(a.pengajuan.approval.rpbj_manager.user_data.name)+" - \n                      "+a._s(a.pengajuan.approval.rpbj_manager.user_data.jabatan.nama)+"\n                  ")]),a._v(" \n                  pada "+a._s(a.pengajuan.approval.rpbj_manager.tanggal)+"\n              ")])]):a._e()])]),a._v(" "),5!=a.pengajuan.status?e("div",{staticClass:"card-header-elements ml-md-auto"},[e("b-badge",{attrs:{variant:"outline-danger"}},[a._v("Read Only")])],1):a._e()]),a._v(" "),e("pengajuan-items",{attrs:{step:a.curStep,accessRead:a.accessRead,accessUpdate:a.accessUpdate}}),a._v(" "),e("rpbj-page",{attrs:{step:a.curStep,isWriteable:!1},on:{onRpbjLoaded:a.onRpbjSetted}}),a._v(" "),e("b-card-body",[e("b-btn",{staticClass:"btn btn-success btn-sm mr-2",attrs:{disabled:!(a.isWriteable&&!a.isDocApproved)},on:{click:a.approveDoc}},[e("i",{staticClass:"ion ion-md-checkmark"}),a._v(" Terima Dokumen\n      ")]),a._v(" "),e("b-btn",{staticClass:"btn btn-warning btn-sm mr-2",attrs:{disabled:!(a.isWriteable&&!a.isDocApproved)},on:{click:a.rejectStep}},[e("i",{staticClass:"ion ion-md-close"}),a._v(" Tolak Dokumen\n      ")]),a._v(" "),e("download-notdin",{staticClass:"float-right",attrs:{notdinCaption:"Nota Dinas ke Laksdan",enable:a.isDocApproved,allowEdit:a.isWriteable,notdinRef:"manlaksdan"}})],1),a._v(" "),e("b-card-footer",{staticClass:"text-right"},[e("b-btn",{staticClass:"btn btn-success btn-sm",attrs:{disabled:!(a.isWriteable&&a.isDocApproved&&a.isNotdinCreated)},on:{click:a.nextStep}},[a._v("Simpan dan teruskan proses")])],1),a._v(" "),a.isWriteable?[e("b-modal",{attrs:{id:"penolakan-modals-form-step6",size:"sm"},on:{ok:a.submitReject}},[e("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[a._v("\n              Form / "),e("span",{staticClass:"font-weight-light"},[a._v("Tolak Dokumen")])]),a._v(" "),e("b-form-row",[e("b-form-group",{staticClass:"col position-relative",attrs:{label:"Alasan Penolakan"}},[e("b-textarea",{attrs:{placeholder:"Alasan Penolakan"},model:{value:a.rejectform.penolakan,callback:function(t){a.$set(a.rejectform,"penolakan","string"==typeof t?t.trim():t)},expression:"rejectform.penolakan"}})],1)],1)],1)]:a._e()],2)},[],!1,null,null,null);t.default=l.exports}}]);