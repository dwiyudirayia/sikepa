(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"3gPr":function(t,a,n){"use strict";n.r(a);var e=n("5eju"),o={name:"pengajuan-step-2",props:["accessUpdate","accessRead"],components:{"pengajuan-items":n("+TlC").a,"download-notdin":e.a},data:function(){return{curStep:2}},computed:{isWriteable:function(){return!(1!=this.pengajuan.status||!this.accessUpdate)},pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(t){this.$store.commit("pengajuan/setOneData",t)}},isApproved:function(){return this.pengajuan.approval&&this.pengajuan.approval.rab_usulan_manager_bagian}},methods:{nextStep:function(){var t=this,a={id:this.pengajuan.id,status:this.curStep};this.$store.dispatch("pengajuan/updatePengajuan",a).then(function(a){t.Web.showAlert({text:"Pengajuan berhasil diproses selanjutnya"}),t.$router.push({name:"pengajuan"})}).catch(function(a){t.Web.showAlert({text:"Save data failed : "+a.message,type:"warning"})})}}},i=n("KHd+"),r=Object(i.a)(o,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("b-card",{attrs:{"no-body":""}},[n("b-card-header",{staticClass:"with-elements"},[n("div",{staticClass:"card-header-title mr-2"},[n("h4",[t._v("Step 2")]),t._v(" "),n("div",[n("span",[t._v("Approval pengajuan (AHS Usulan) oleh Manager Bagian")]),t._v(" "),t.isApproved?n("p",[n("i",[t._v("\n                  Disetujui oleh \n                  "),n("b",[t._v("\n                      "+t._s(t.pengajuan.approval.rab_usulan_manager_bagian.user_data.name)+" - \n                      "+t._s(t.pengajuan.approval.rab_usulan_manager_bagian.user_data.jabatan.nama)+"\n                  ")]),t._v(" \n                  pada "+t._s(t.pengajuan.approval.rab_usulan_manager_bagian.tanggal)+"\n              ")])]):t._e()])]),t._v(" "),1!=t.pengajuan.status?n("div",{staticClass:"card-header-elements ml-md-auto"},[n("b-badge",{attrs:{variant:"outline-danger"}},[t._v("Read Only")])],1):t._e()]),t._v(" "),n("pengajuan-items",{attrs:{step:t.curStep,accessRead:t.accessRead,accessUpdate:t.accessUpdate}}),t._v(" "),n("b-card-footer",[n("b-btn",{staticClass:"btn btn-success btn-sm float-right",attrs:{disabled:!(t.isWriteable&&1==t.pengajuan.rab_final)},on:{click:t.nextStep}},[t._v("Setujui dan teruskan proses")])],1)],1)},[],!1,null,null,null);a.default=r.exports},"5eju":function(t,a,n){"use strict";var e=n("ta7f"),o={name:"download-notdin",props:["notdinRef","notdinCaption","enable","allowEdit"],components:{Datepicker:n("+jP+").a},validations:{form:{nomor:{required:Object(e.requiredIf)(function(t){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},tanggal:{required:e.required},sifat:{required:Object(e.requiredIf)(function(t){return"rab"!=this.notdinRef&&"renevman"!=this.notdinRef})},perihal:{required:Object(e.requiredIf)(function(t){return"manrenev"==this.notdinRef||"manlaksdan"==this.notdinRef})}}},data:function(){return{form:{nomor:"",tanggal:"",sifat:"",perihal:""}}},computed:{pengajuan:{get:function(){return this.$store.state.pengajuan.oneData},set:function(t){this.$store.commit("pengajuan/setOneData",t)}}},created:function(){var t=this;this.$store.dispatch("pengajuan/getNotdin",{notdinREf:this.notdinRef,pId:this.pengajuan.id}).then(function(a){"rab"==t.notdinRef?(t.form.nomor=a.no_notdin,t.form.tanggal=null!=a.tgl_notdin?new Date(a.tgl_notdin):new Date):(t.form.nomor=a.nomor,t.form.tanggal=new Date(a.tanggal),""==a.perihal?t.form.perihal=a.perihal:t.form.perihal=t.pengajuan.nama_pekerjaan,"manrenev"!=t.notdinRef&&"manlaksdan"!=t.notdinRef||(a.sifat?t.form.sifat=a.sifat:t.form.sifat="Segera"))}).catch(function(a){console.log("load notdin "+t.notdinRef+" error : ",a),"manrenev"==t.notdinRef?t.form.perihal="Tindaklanjut Proses Evaluasi RAB":"manlaksdan"==t.notdinRef&&(t.form.perihal="Tindaklanjut Proses Pengadaan"),t.form.tanggal=new Date,t.form.sifat="Segera"})},methods:{showForm:function(t){this.$bvModal.show("notdin-modals-"+this.notdinRef)},formSubmitted:function(t){var a=this;if(t.preventDefault(),this.allowEdit){if(this.$v.$touch(),this.$v.$invalid)return this.Web.showAlert({text:"Please fix form error",title:"Alert",type:"warning"}),!1;this.$store.dispatch("pengajuan/saveNotdin",{notdinRef:this.notdinRef,pId:this.pengajuan.id,data:this.form}).then(function(t){a.Web.showAlert({text:"Data saved"}),a.$bvModal.hide("notdin-modals-"+a.notdinRef),a.download("notdin_"+a.notdinRef+"/"+a.pengajuan.id,"notdin_"+a.notdinRef+".docx")}).catch(function(t){a.Web.showAlert({text:"Save data failed : "+t.message,type:"warning"})})}else this.$bvModal.hide("notdin-modals-"+this.notdinRef),this.download("notdin_"+this.notdinRef+"/"+this.pengajuan.id,"notdin_"+this.notdinRef+".docx")}}},i=n("KHd+"),r=Object(i.a)(o,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("span",[n("b-btn",{staticClass:"btn btn-info btn-sm",attrs:{disabled:!t.enable},on:{click:t.showForm}},[t._v("Unduh "+t._s(t.notdinCaption))]),t._v(" "),t.enable?[n("b-modal",{attrs:{id:"notdin-modals-"+t.notdinRef,size:"sm"},on:{ok:t.formSubmitted,hidden:t.$v.$reset}},[n("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[t._v("\n        Form /\n        "),n("span",{staticClass:"font-weight-light"},[t._v(t._s(t.notdinCaption))]),t._v(" "),n("br")]),t._v(" "),"rab"!=t.notdinRef&&"renevman"!=t.notdinRef?n("b-form-row",[n("b-form-group",{staticClass:"col position-relative",attrs:{label:"Nomor"}},[n("b-input",{attrs:{state:t.$v.form.nomor.$error?"invalid":"",placeholder:"Nomor Nota Dinas",disabled:!t.allowEdit},on:{blur:function(a){return t.$v.form.nomor.$touch()}},model:{value:t.form.nomor,callback:function(a){t.$set(t.form,"nomor","string"==typeof a?a.trim():a)},expression:"form.nomor"}}),t._v(" "),n("invalid-tooltip",{attrs:{inputItem:t.$v.form.nomor,fieldName:"Nomor"}})],1)],1):t._e(),t._v(" "),n("b-form-row",[n("b-form-group",{staticClass:"col position-relative",attrs:{label:"Tanggal"}},[n("datepicker",{attrs:{bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Tanggal","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0,disabled:!t.allowEdit},model:{value:t.form.tanggal,callback:function(a){t.$set(t.form,"tanggal",a)},expression:"form.tanggal"}}),t._v(" "),n("invalid-tooltip",{attrs:{inputItem:t.$v.form.tanggal,fieldName:"Tanggal"}})],1)],1),t._v(" "),"rab"!=t.notdinRef&&"renevman"!=t.notdinRef?n("b-form-row",[n("b-form-group",{staticClass:"col position-relative",attrs:{label:"Sifat"}},[n("b-input",{attrs:{state:t.$v.form.sifat.$error?"invalid":"",placeholder:"Sifat",disabled:!t.allowEdit},on:{blur:function(a){return t.$v.form.sifat.$touch()}},model:{value:t.form.sifat,callback:function(a){t.$set(t.form,"sifat","string"==typeof a?a.trim():a)},expression:"form.sifat"}}),t._v(" "),n("invalid-tooltip",{attrs:{inputItem:t.$v.form.sifat,fieldName:"Sifat"}})],1)],1):t._e(),t._v(" "),"manrenev"==t.notdinRef||"manlaksdan"==t.notdinRef?n("b-form-row",[n("b-form-group",{staticClass:"col position-relative",attrs:{label:"Perihal"}},[n("b-input",{attrs:{state:t.$v.form.perihal.$error?"invalid":"",placeholder:"Perihal",disabled:!t.allowEdit},on:{blur:function(a){return t.$v.form.perihal.$touch()}},model:{value:t.form.perihal,callback:function(a){t.$set(t.form,"perihal","string"==typeof a?a.trim():a)},expression:"form.perihal"}}),t._v(" "),n("invalid-tooltip",{attrs:{inputItem:t.$v.form.perihal,fieldName:"Perihal"}})],1)],1):t._e()],1)]:t._e()],2)},[],!1,null,null,null);a.a=r.exports}}]);